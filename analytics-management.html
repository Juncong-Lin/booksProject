<!DOCTYPE html>
<html>
  <head>
    <title>Product Discovery Data Management - Juncongmall.com</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no"
    />

    <!-- Load fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />

    <!-- CSS files -->
    <link rel="stylesheet" href="styles/shared/general.css" />
    <link rel="stylesheet" href="styles/shared/qili-header.css" />
    <link rel="stylesheet" href="styles/shared/sub-header.css" />
    <link rel="stylesheet" href="styles/pages/dashboard.css" />
    <link rel="stylesheet" href="styles/pages/analytics-management.css" />
    <link rel="stylesheet" href="styles/shared/footer.css" />

    <!-- Additional libraries for enhanced UI -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
  </head>

  <body class="no-sidebar dashboard-theme">
    <!-- Header -->
    <div id="shared-header-placeholder"></div>
    <div id="shared-subheader-placeholder"></div>

    <!-- Gradient Background -->
    <div class="dashboard-background">
      <div class="gradient-orb orb-1"></div>
      <div class="gradient-orb orb-2"></div>
      <div class="gradient-orb orb-3"></div>
    </div>

    <div class="main">
      <div class="management-container animate__animated animate__fadeIn">
        <!-- Dashboard Header -->
        <div class="management-header">
          <div class="header-content">
            <div class="title-section">
              <h1 class="management-title">
                <i data-feather="settings" class="title-icon"></i>
                Product Discovery Data Management
              </h1>
              <p class="management-subtitle">
                Manage and monitor your product discovery analytics data with
                advanced controls for homepage engagement tracking
              </p>
            </div>
            <div class="header-actions">
              <button class="action-btn refresh-btn" id="refresh-system">
                <i data-feather="refresh-cw"></i>
                <span>Refresh</span>
              </button>
              <a href="dashboard.html" class="action-btn primary">
                <i data-feather="shopping-bag"></i>
                <span>View Dashboard</span>
              </a>
            </div>
          </div>

          <!-- Live Status Indicator -->
          <div class="live-status">
            <div class="status-indicator">
              <div class="status-dot"></div>
              <span>System Online</span>
            </div>
            <div class="connection-status">
              <span id="dashboard-connection-status"
                >Dashboard: Not Connected</span
              >
            </div>
            <div class="last-updated">
              Last action: <span id="last-action-time">System initialized</span>
            </div>
          </div>
        </div>

        <!-- Product Discovery Data Statistics Cards -->
        <div
          class="data-stats animate__animated animate__slideInUp"
          style="animation-delay: 0.1s"
        >
          <div class="stat-card">
            <div class="stat-value" id="category-clicks-stat">0</div>
            <div class="stat-label">Category Clicks</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="product-clicks-stat">0</div>
            <div class="stat-label">Product Clicks</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="search-queries-stat">0</div>
            <div class="stat-label">Search Queries</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="cart-additions-stat">0</div>
            <div class="stat-label">Cart Additions</div>
          </div>
        </div>

        <div class="action-cards">
          <div
            class="action-card animate__animated animate__slideInUp"
            style="animation-delay: 0.2s"
          >
            <div class="card-header">
              <div class="card-icon clear-data">
                <i data-feather="trash-2"></i>
              </div>
            </div>
            <h3>Clear Product Discovery Data</h3>
            <p>
              Remove all stored product discovery analytics data including
              category clicks, product views, and search queries. This action
              cannot be undone.
            </p>
            <button class="action-btn danger" onclick="clearProductData()">
              <i data-feather="trash-2"></i>
              Clear Discovery Data
            </button>
          </div>

          <div
            class="action-card animate__animated animate__slideInUp"
            style="animation-delay: 0.3s"
          >
            <div class="card-header">
              <div class="card-icon generate-data">
                <i data-feather="shuffle"></i>
              </div>
            </div>
            <h3>Generate Product Discovery Data</h3>
            <p>
              Create realistic sample product discovery data including category
              navigation, product clicks, search queries, and cart additions for
              testing.
            </p>
            <button
              class="action-btn success"
              onclick="generateProductDiscoveryData()"
            >
              <i data-feather="shuffle"></i>
              Generate Discovery Data
            </button>
          </div>

          <div
            class="action-card animate__animated animate__slideInUp"
            style="animation-delay: 0.4s"
          >
            <div class="card-header">
              <div class="card-icon view-data">
                <i data-feather="eye"></i>
              </div>
            </div>
            <h3>View Current Discovery Data</h3>
            <p>
              Display a summary of current product discovery analytics including
              category performance, search patterns, and conversion metrics.
            </p>
            <button class="action-btn" onclick="showCurrentDiscoveryData()">
              <i data-feather="eye"></i>
              Show Discovery Summary
            </button>
          </div>

          <div
            class="action-card animate__animated animate__slideInUp"
            style="animation-delay: 0.5s"
          >
            <div class="card-header">
              <div class="card-icon export-data">
                <i data-feather="download"></i>
              </div>
            </div>
            <h3>Export Product Discovery Data</h3>
            <p>
              Download all product discovery analytics data as a JSON file for
              backup or external analysis. Includes category performance and
              user journey data.
            </p>
            <button class="action-btn warning" onclick="exportDiscoveryData()">
              <i data-feather="download"></i>
              Export Discovery Data
            </button>
          </div>
        </div>

        <div
          class="quick-actions animate__animated animate__slideInUp"
          style="animation-delay: 0.6s"
        >
          <a href="dashboard.html" class="quick-btn">
            <i data-feather="shopping-bag"></i>
            View Dashboard
          </a>
          <button class="quick-btn" onclick="refreshProductAnalytics()">
            <i data-feather="refresh-cw"></i>
            Refresh Analytics
          </button>
          <button class="quick-btn" onclick="simulateProductActivity()">
            <i data-feather="activity"></i>
            Simulate Activity
          </button>
          <button class="quick-btn" onclick="validateProductData()">
            <i data-feather="check-circle"></i>
            Validate Data
          </button>
        </div>

        <div
          class="output-section animate__animated animate__slideInUp"
          style="animation-delay: 0.7s"
        >
          <div class="output-header">
            <h3>
              <i data-feather="terminal"></i>
              System Output
            </h3>
            <button class="clear-output-btn" onclick="clearOutput()">
              <i data-feather="x"></i>
              Clear Output
            </button>
          </div>
          <div id="output" class="output-content"></div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div id="shared-footer-placeholder"></div>

    <!-- Scripts -->
    <script type="module">
      import { SimpleAnalytics } from "./scripts/shared/analytics.js";

      // Helper function to show loading state
      function showLoading(button) {
        button.classList.add("loading");
        button.disabled = true;
      }

      function hideLoading(button) {
        button.classList.remove("loading");
        button.disabled = false;
      }

      // Helper function to update last action time
      function updateLastActionTime(action) {
        const timestamp = new Date().toLocaleTimeString();
        const lastActionElement = document.getElementById("last-action-time");
        if (lastActionElement) {
          lastActionElement.textContent = `${action} at ${timestamp}`;
        }
      }

      // Helper function to update product discovery statistics
      function updateStats() {
        try {
          // Get data from localStorage that matches dashboard structure
          const productDiscoveryData = getProductDiscoveryData();

          document.getElementById("category-clicks-stat").textContent =
            productDiscoveryData.categoryClicks || 0;
          document.getElementById("product-clicks-stat").textContent =
            productDiscoveryData.productClicks || 0;
          document.getElementById("search-queries-stat").textContent =
            productDiscoveryData.searchQueries || 0;
          document.getElementById("cart-additions-stat").textContent =
            productDiscoveryData.cartAdditions || 0;
        } catch (error) {
          console.error("Error updating product discovery stats:", error);
        }
      }

      // Helper function to get product discovery data that matches dashboard
      function getProductDiscoveryData() {
        const stored = localStorage.getItem("product_discovery_data");
        if (stored) {
          return JSON.parse(stored);
        }

        // Return empty data structure if none exists (don't auto-generate)
        return {
          categoryClicks: 0,
          productClicks: 0,
          searchQueries: 0,
          cartAdditions: 0,
          homepageVisits: 0,
          categoryPerformance: {},
          dailyDiscoveryActions: [],
          lastUpdated: Date.now(),
        };
      }

      // Helper function to sync data with dashboard
      function syncWithDashboard(data) {
        localStorage.setItem("product_discovery_data", JSON.stringify(data));
        // Also trigger dashboard update if it's open
        if (window.opener && !window.opener.closed) {
          window.opener.postMessage(
            { type: "productDiscoveryUpdate", data: data },
            "*"
          );
        }
      }

      // Helper function to add output with timestamp and animation
      function addOutput(message, type = "info") {
        const output = document.getElementById("output");
        const timestamp = new Date().toLocaleTimeString();
        const typeIcon =
          {
            info: "ℹ️",
            success: "✅",
            warning: "⚠️",
            error: "❌",
            system: "⚙️",
          }[type] || "ℹ️";

        const newContent = `[${timestamp}] ${typeIcon} ${message}\n`;
        output.textContent = newContent + output.textContent;

        // Auto-scroll to top for new content
        output.scrollTop = 0;

        // Update stats after any data operation
        updateStats();
      }

      // Enhanced functions for product discovery data management
      window.clearProductData = function () {
        const button = event.target.closest(".action-btn");
        const card = button.closest(".action-card");

        // Show confirmation dialog
        if (
          !confirm(
            "Are you sure you want to clear all product discovery data? This action cannot be undone."
          )
        ) {
          return;
        }

        showLoading(button);
        showProgressIndicator();

        setTimeout(() => {
          localStorage.removeItem("product_discovery_data");
          localStorage.removeItem("category_performance_data");
          localStorage.removeItem("search_analytics_data");
          addOutput("Product discovery data cleared successfully!", "success");
          addOutput(
            "All category clicks, product views, and search queries have been removed.",
            "info"
          );
          addOutput("Dashboard will reset to initial state.", "system");
          updateLastActionTime("Product data cleared");
          hideLoading(button);
          hideProgressIndicator();
          addFeedbackToCard(card, "success");
          showNotification(
            "All product discovery data cleared successfully!",
            "success"
          );

          // Sync with dashboard immediately with empty data structure
          const emptyData = {
            categoryClicks: 0,
            productClicks: 0,
            searchQueries: 0,
            cartAdditions: 0,
            homepageVisits: 0,
            dailyDiscoveryActions: [],
            categoryPerformance: [],
          };
          syncWithDashboard(emptyData);
        }, 500);
      };

      window.generateProductDiscoveryData = function () {
        const button = event.target.closest(".action-btn");
        const card = button.closest(".action-card");
        showLoading(button);
        showProgressIndicator();

        setTimeout(() => {
          const productData = {
            categoryClicks: Math.floor(Math.random() * 3000) + 2000,
            productClicks: Math.floor(Math.random() * 2500) + 1500,
            searchQueries: Math.floor(Math.random() * 800) + 600,
            cartAdditions: Math.floor(Math.random() * 600) + 300,
            homepageVisits: Math.floor(Math.random() * 6000) + 4000,
            categoryPerformance: {
              Fiction: Math.floor(Math.random() * 500) + 1000,
              Romance: Math.floor(Math.random() * 400) + 700,
              Mystery: Math.floor(Math.random() * 300) + 600,
              "Science Fiction": Math.floor(Math.random() * 250) + 500,
              "Young Adult": Math.floor(Math.random() * 200) + 450,
            },
            searchPatterns: [
              {
                query: "fiction books",
                count: Math.floor(Math.random() * 50) + 20,
              },
              {
                query: "bestsellers",
                count: Math.floor(Math.random() * 40) + 15,
              },
              {
                query: "romance novels",
                count: Math.floor(Math.random() * 35) + 12,
              },
              {
                query: "mystery books",
                count: Math.floor(Math.random() * 30) + 10,
              },
              {
                query: "sci-fi series",
                count: Math.floor(Math.random() * 25) + 8,
              },
            ],
            lastUpdated: Date.now(),
          };

          syncWithDashboard(productData);

          addOutput(
            "Product discovery data generated successfully!",
            "success"
          );
          addOutput(
            `Generated ${productData.categoryClicks} category clicks and ${productData.productClicks} product views.`,
            "info"
          );
          addOutput(
            `Search queries: ${productData.searchQueries}, Cart additions: ${productData.cartAdditions}`,
            "info"
          );
          addOutput(
            "Data includes realistic category performance and search patterns.",
            "system"
          );
          updateLastActionTime("Product discovery data generated");
          hideLoading(button);
          hideProgressIndicator();
          addFeedbackToCard(card, "success");
          showNotification(
            `Generated comprehensive product discovery data!`,
            "success"
          );
        }, 1500);
      };

      window.showCurrentDiscoveryData = function () {
        const button = event.target.closest(".action-btn");
        const card = button.closest(".action-card");
        showLoading(button);
        showProgressIndicator();

        setTimeout(() => {
          const data = getProductDiscoveryData();
          addOutput("Current product discovery data summary:", "info");
          addOutput(`Category Clicks: ${data.categoryClicks}`, "system");
          addOutput(`Product Clicks: ${data.productClicks}`, "system");
          addOutput(`Search Queries: ${data.searchQueries}`, "system");
          addOutput(`Cart Additions: ${data.cartAdditions}`, "system");

          if (data.categoryPerformance) {
            addOutput("Category Performance:", "info");
            Object.entries(data.categoryPerformance).forEach(
              ([category, clicks]) => {
                addOutput(`  ${category}: ${clicks} clicks`, "system");
              }
            );
          }

          if (data.searchPatterns) {
            addOutput("Top Search Patterns:", "info");
            data.searchPatterns.slice(0, 3).forEach((pattern) => {
              addOutput(
                `  "${pattern.query}": ${pattern.count} searches`,
                "system"
              );
            });
          }

          updateLastActionTime("Discovery data viewed");
          hideLoading(button);
          hideProgressIndicator();
          addFeedbackToCard(card, "success");
          showNotification(
            "Discovery data summary displayed in output",
            "info"
          );
        }, 800);
      };

      window.exportDiscoveryData = function () {
        const button = event.target.closest(".action-btn");
        const card = button.closest(".action-card");
        showLoading(button);
        showProgressIndicator();

        setTimeout(() => {
          const data = getProductDiscoveryData();
          const exportData = {
            productDiscovery: data,
            exportTimestamp: new Date().toISOString(),
            dashboardCompatible: true,
            version: "1.0",
          };

          const dataStr = JSON.stringify(exportData, null, 2);
          const dataBlob = new Blob([dataStr], { type: "application/json" });
          const url = URL.createObjectURL(dataBlob);
          const link = document.createElement("a");
          link.href = url;
          const filename = `product-discovery-data-${
            new Date().toISOString().split("T")[0]
          }.json`;
          link.download = filename;
          link.click();
          URL.revokeObjectURL(url);

          addOutput("Product discovery data exported successfully!", "success");
          addOutput(`File: ${filename}`, "info");
          addOutput(
            `Exported ${data.categoryClicks} category clicks and related metrics.`,
            "system"
          );
          updateLastActionTime("Discovery data exported");
          hideLoading(button);
          hideProgressIndicator();
          addFeedbackToCard(card, "success");
          showNotification(`Discovery data exported as ${filename}`, "success");
        }, 1000);
      };

      window.refreshProductAnalytics = function () {
        const button = event.target.closest(".quick-btn");
        showLoading(button);
        showProgressIndicator();

        setTimeout(() => {
          // Refresh product discovery data
          const data = getProductDiscoveryData();
          data.lastUpdated = Date.now();
          syncWithDashboard(data);

          addOutput("Product discovery analytics refreshed!", "success");
          addOutput("Category performance data updated.", "info");
          addOutput(
            "Search patterns and conversion metrics refreshed.",
            "system"
          );
          updateLastActionTime("Product analytics refreshed");
          hideLoading(button);
          hideProgressIndicator();
          showNotification("Product discovery analytics refreshed!", "success");
        }, 1200);
      };

      // New interactive functions for product discovery
      window.simulateProductActivity = function () {
        const button = event.target.closest(".quick-btn");
        showLoading(button);
        showProgressIndicator();

        setTimeout(() => {
          const data = getProductDiscoveryData();

          // Simulate product discovery activities
          const activities = [
            {
              type: "category_click",
              category: "Fiction",
              increment: Math.floor(Math.random() * 20) + 10,
            },
            {
              type: "product_click",
              product: "The Silent Patient",
              increment: Math.floor(Math.random() * 15) + 5,
            },
            {
              type: "search_query",
              query: "bestsellers 2024",
              increment: Math.floor(Math.random() * 10) + 3,
            },
            {
              type: "cart_addition",
              product: "Dune Series",
              increment: Math.floor(Math.random() * 8) + 2,
            },
          ];

          activities.forEach((activity, index) => {
            setTimeout(() => {
              switch (activity.type) {
                case "category_click":
                  data.categoryClicks += activity.increment;
                  if (
                    data.categoryPerformance &&
                    data.categoryPerformance[activity.category]
                  ) {
                    data.categoryPerformance[activity.category] +=
                      activity.increment;
                  }
                  addOutput(
                    `Simulated ${activity.increment} clicks on ${activity.category} category`,
                    "system"
                  );
                  break;
                case "product_click":
                  data.productClicks += activity.increment;
                  addOutput(
                    `Simulated ${activity.increment} clicks on ${activity.product}`,
                    "system"
                  );
                  break;
                case "search_query":
                  data.searchQueries += activity.increment;
                  addOutput(
                    `Simulated ${activity.increment} searches for "${activity.query}"`,
                    "system"
                  );
                  break;
                case "cart_addition":
                  data.cartAdditions += activity.increment;
                  addOutput(
                    `Simulated ${activity.increment} cart additions for ${activity.product}`,
                    "system"
                  );
                  break;
              }
            }, index * 300);
          });

          setTimeout(() => {
            syncWithDashboard(data);
            addOutput(
              "Product discovery activity simulation completed!",
              "success"
            );
            addOutput(
              "Dashboard metrics have been updated with new activity.",
              "info"
            );
            updateLastActionTime("Product activity simulated");
            hideLoading(button);
            hideProgressIndicator();
            showNotification(
              "Successfully simulated product discovery activities!",
              "success"
            );
          }, 1500);
        }, 500);
      };

      window.validateProductData = function () {
        const button = event.target.closest(".quick-btn");
        showLoading(button);
        showProgressIndicator();

        setTimeout(() => {
          const data = getProductDiscoveryData();
          let issues = 0;

          addOutput("Starting product discovery data validation...", "info");

          // Check for data integrity
          if (!data.categoryClicks && data.categoryClicks !== 0) {
            addOutput("⚠️ Missing category clicks data", "warning");
            issues++;
          }

          if (!data.productClicks && data.productClicks !== 0) {
            addOutput("⚠️ Missing product clicks data", "warning");
            issues++;
          }

          if (!data.searchQueries && data.searchQueries !== 0) {
            addOutput("⚠️ Missing search queries data", "warning");
            issues++;
          }

          if (!data.cartAdditions && data.cartAdditions !== 0) {
            addOutput("⚠️ Missing cart additions data", "warning");
            issues++;
          }

          // Check data consistency
          if (data.cartAdditions > data.productClicks) {
            addOutput(
              "⚠️ Cart additions exceed product clicks (impossible scenario)",
              "warning"
            );
            issues++;
          }

          if (data.productClicks > data.categoryClicks) {
            addOutput(
              "⚠️ Product clicks exceed category clicks (unusual pattern)",
              "warning"
            );
            issues++;
          }

          // Check category performance consistency
          if (data.categoryPerformance) {
            const totalCategoryClicks = Object.values(
              data.categoryPerformance
            ).reduce((a, b) => a + b, 0);
            if (
              Math.abs(totalCategoryClicks - data.categoryClicks) >
              data.categoryClicks * 0.1
            ) {
              addOutput(
                "⚠️ Category performance doesn't match total category clicks",
                "warning"
              );
              issues++;
            }
          }

          if (issues === 0) {
            addOutput(
              "✅ Product discovery data validation completed successfully!",
              "success"
            );
            addOutput(
              "No issues found in product discovery analytics.",
              "info"
            );
            addOutput("Dashboard data integrity confirmed.", "system");
            showNotification(
              "Data validation passed! No issues found.",
              "success"
            );
          } else {
            addOutput(
              `Product discovery data validation completed with ${issues} issues found.`,
              "warning"
            );
            showNotification(
              `Data validation found ${issues} issues.`,
              "warning"
            );
          }

          updateLastActionTime("Product data validated");
          hideLoading(button);
          hideProgressIndicator();
        }, 1500);
      };

      window.clearOutput = function () {
        document.getElementById("output").textContent = "";
        updateLastActionTime("Output cleared");
      };

      // Initialize page
      document.addEventListener("DOMContentLoaded", () => {
        // Initialize Feather icons
        feather.replace();

        // Initialize search system
        if (window.searchSystem) {
          window.searchSystem.init();
        } else {
          // Try to import and initialize if not available globally
          import("./scripts/shared/search.js")
            .then((module) => {
              if (module.searchSystem) {
                module.searchSystem.init();
              }
            })
            .catch((error) => {
              console.log("Search system initialization failed:", error);
            });
        }

        // Update initial stats
        updateStats();

        addOutput(
          "Product Discovery Data Management system initialized.",
          "success"
        );
        addOutput(
          "Ready to manage your product discovery analytics data.",
          "info"
        );
        addOutput(
          "Connected to dashboard for real-time data synchronization.",
          "system"
        );

        // Listen for dashboard updates
        window.addEventListener("message", (event) => {
          if (event.data.type === "dashboardMetricsUpdate") {
            addOutput("Received metrics update from dashboard", "info");
            updateStats();
          }
        });

        // Send initial data to dashboard if it exists
        const initialData = getProductDiscoveryData();
        if (window.opener && !window.opener.closed) {
          window.opener.postMessage(
            { type: "productDiscoveryUpdate", data: initialData },
            "*"
          );
        }

        // Add refresh button functionality
        const refreshBtn = document.getElementById("refresh-system");
        if (refreshBtn) {
          refreshBtn.addEventListener("click", function () {
            showProgressIndicator();
            setTimeout(() => {
              hideProgressIndicator();
              updateStats();
              addOutput("System status refreshed.", "info");
              updateLastActionTime("System refreshed");
              showNotification("System refreshed successfully!", "success");
            }, 1000);
          });
        }

        // Auto-update stats every 30 seconds
        setInterval(() => {
          updateStats();
        }, 30000);

        // Add keyboard shortcuts for product discovery functions
        document.addEventListener("keydown", (e) => {
          if (e.ctrlKey || e.metaKey) {
            switch (e.key) {
              case "r":
                e.preventDefault();
                refreshProductAnalytics();
                break;
              case "e":
                e.preventDefault();
                exportDiscoveryData();
                break;
              case "s":
                e.preventDefault();
                simulateProductActivity();
                break;
              case "v":
                e.preventDefault();
                validateProductData();
                break;
            }
          }
        });

        // Add visual feedback to action cards
        const actionCards = document.querySelectorAll(".action-card");
        actionCards.forEach((card) => {
          card.addEventListener("mouseenter", () => {
            card.style.transform = "translateY(-8px) scale(1.02)";
          });

          card.addEventListener("mouseleave", () => {
            card.style.transform = "translateY(0) scale(1)";
          });
        });

        // Initialize tooltips for keyboard shortcuts
        addKeyboardShortcutTooltips();
      });

      // Enhanced utility functions
      function showProgressIndicator() {
        let indicator = document.querySelector(".progress-indicator");
        if (!indicator) {
          indicator = document.createElement("div");
          indicator.className = "progress-indicator";
          document.body.appendChild(indicator);
        }
        indicator.classList.add("active");
      }

      function hideProgressIndicator() {
        const indicator = document.querySelector(".progress-indicator");
        if (indicator) {
          indicator.classList.remove("active");
        }
      }

      function showNotification(message, type = "info") {
        const notification = document.createElement("div");
        notification.className = `notification ${type}`;
        notification.textContent = message;

        document.body.appendChild(notification);

        // Trigger animation
        setTimeout(() => {
          notification.classList.add("show");
        }, 100);

        // Auto-remove after 3 seconds
        setTimeout(() => {
          notification.classList.remove("show");
          setTimeout(() => {
            if (notification.parentNode) {
              notification.parentNode.removeChild(notification);
            }
          }, 300);
        }, 3000);
      }

      function addKeyboardShortcutTooltips() {
        const shortcuts = [
          {
            selector: '[onclick="refreshProductAnalytics()"]',
            shortcut: "Ctrl+R",
          },
          { selector: '[onclick="exportDiscoveryData()"]', shortcut: "Ctrl+E" },
          {
            selector: '[onclick="simulateProductActivity()"]',
            shortcut: "Ctrl+S",
          },
          { selector: '[onclick="validateProductData()"]', shortcut: "Ctrl+V" },
        ];

        shortcuts.forEach(({ selector, shortcut }) => {
          const element = document.querySelector(selector);
          if (element) {
            element.title = `${element.textContent.trim()} (${shortcut})`;
          }
        });
      }

      function addFeedbackToCard(card, type) {
        card.classList.remove("feedback-success", "feedback-error");
        card.classList.add(`feedback-${type}`);

        setTimeout(() => {
          card.classList.remove(`feedback-${type}`);
        }, 2000);
      }
    </script>

    <!-- Shared component loaders -->
    <script src="scripts/shared/url-utils.js"></script>
    <script src="scripts/shared/shared-header-loader.js"></script>
    <script src="scripts/shared/shared-subheader-loader.js"></script>
    <script src="scripts/shared/shared-footer-loader.js"></script>
    <script src="scripts/shared/sub-header-nav.js"></script>
    <script type="module" src="scripts/shared/search.js"></script>

    <!-- Initialize additional features -->
    <script>
      // Add CSS for button spinning animation
      const style = document.createElement("style");
      style.textContent = `
        .spinning {
          animation: spin 1s linear infinite;
        }
        
        .action-btn:active {
          transform: translateY(0px);
        }
        
        .quick-btn:active {
          transform: translateY(0px);
        }
        
        /* Hover effects for icons */
        .card-icon {
          transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .action-card:hover .card-icon {
          transform: scale(1.1) rotate(5deg);
        }
        
        /* Interactive button states */
        .action-btn:hover:not(.loading) {
          transform: translateY(-2px) scale(1.02);
        }
        
        .quick-btn:hover:not(.loading) {
          transform: translateY(-2px) scale(1.02);
        }
        
        /* Success/Error feedback */
        .feedback-success {
          border-color: #10b981 !important;
          background: rgba(16, 185, 129, 0.1) !important;
        }
        
        .feedback-error {
          border-color: #ef4444 !important;
          background: rgba(239, 68, 68, 0.1) !important;
        }
      `;
      document.head.appendChild(style);
    </script>
  </body>
</html>
